<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Import - Salgstal 3.1</title>

    <!-- Dollar Sign Favicon -->
    <link rel="icon" type="image/svg+xml" href="https://icons.iconarchive.com/icons/papirus-team/papirus-apps/128/money-manager-ex-icon.png" width="128" height="128">

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Inter%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />
    <style>
        body {
            font-family: Inter, "Noto Sans", sans-serif;
        }
    </style>
</head>
<body>
    <div class="relative flex size-full min-h-screen flex-col bg-gray-100">
        <div class="layout-container flex h-full grow flex-col bg-gray-100">
            <!-- Header -->
            <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-slate-200 px-10 py-3">
                <div class="flex items-center gap-4 text-slate-900">
                    <div class="h-8 w-auto">
                        <img src="../assets/images/LBERHVERV LOGO.png" alt="LB Erhverv Logo" class="h-full w-auto object-contain">
                    </div>
                    <h2 class="text-slate-900 text-lg font-bold leading-tight tracking-[-0.015em]">Salgsrapport</h2>
                </div>
                <div class="flex flex-1 justify-end gap-8">
                    <div class="flex items-center gap-9">
                        <a class="nav-link text-sm font-medium leading-normal cursor-pointer" href="dashboard.html" data-page="dashboard">Dashboard</a>
                        <a class="nav-link text-sm font-medium leading-normal cursor-pointer" href="advisors.html" data-page="advisors">Rådgivere</a>
                        <a class="nav-link text-sm font-medium leading-normal cursor-pointer" href="data.html" data-page="data">Data</a>
                    </div>
                    <div id="admin-icon" class="size-10">
                        <img src="../assets/images/profilelb.png" alt="Profile" class="w-full h-full">
                    </div>
                </div>
            </header>

            <!-- Main Content -->
            <div class="px-40 flex flex-1 justify-center py-5 bg-gray-100">
                <div class="layout-content-container flex flex-col max-w-6xl flex-1">

                    <div class="flex flex-wrap justify-between gap-3 p-4">
                        <div class="flex min-w-72 flex-col gap-3">
                            <p class="text-slate-900 tracking-light text-[32px] font-bold leading-tight">Data Import</p>
                            <p class="text-slate-600 text-sm font-normal leading-normal">Konverter Excel-filer til JavaScript med automatisk datohåndtering</p>
                        </div>
                    </div>

                    <div class="px-4 pb-6">
                        <div class="rounded-lg border border-slate-200 p-6 bg-blue-50">
                            <h3 class="text-slate-900 font-semibold mb-3">Sådan bruges quad Excel til JavaScript konverteren:</h3>
                            <ol class="text-slate-700 text-sm space-y-2">
                                <li><strong>1.</strong> Træk alle 4 Excel-filer (AXA Konverterede, AXA Ikke-konverterede, Nærsikring og Afviste) ind i upload-feltet herunder.</li>
                                <li><strong>2.</strong> Systemet genkender automatisk filerne baseret på deres navne.</li>
                                <li><strong>3.</strong> Tjek statusoversigten for at sikre, at alle 4 filer er fundet (markeres med grønt).</li>
                                <li><strong>4.</strong> (Valgfrit) Vælg en mappe til automatisk gemning.</li>
                                <li><strong>5.</strong> Klik "Konverter til JavaScript", når alle filer er klar.</li>
                                <li><strong>6.</strong> Download den sammenfletede JavaScript-fil.</li>
                            </ol>
                            <p class="text-slate-600 text-xs mt-3">
                                <strong>Note:</strong> Filen vil automatisk få navnet "konverterede_accepterede_tilbud_DDMMYYYY.js"
                                og skal placeres i datamappen i OneDrive.
                            </p>
                        </div>
                    </div>

                    <div class="flex flex-col gap-6 px-4 py-6">

                        <div class="flex min-w-full flex-col gap-6 rounded-lg border border-slate-200 p-6 bg-white">
                            <div class="flex flex-col gap-4">
                                <p class="text-slate-900 text-xl font-bold leading-normal">Trin 1: Upload filer</p>
                                <p class="text-sm text-slate-600">Træk alle 4 Excel-filer herind på én gang (eller klik for at vælge dem).</p>

                                <div id="master-drop-zone" class="border-2 border-dashed border-slate-400 rounded-lg p-10 text-center cursor-pointer transition-all duration-200 hover:border-slate-600 hover:bg-slate-50 bg-slate-50/50">
                                    <div class="flex flex-col items-center gap-4">
                                        <div class="p-4 bg-slate-100 rounded-full">
                                            <svg class="w-12 h-12 text-slate-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                                            </svg>
                                        </div>

                                        <div>
                                            <p class="text-lg font-medium text-slate-900">Træk & Slip filer her</p>
                                            <p class="text-sm text-slate-500 mt-1">Accepterer .xlsx filer</p>
                                        </div>

                                        <button id="master-file-select-btn" class="mt-2 px-6 py-2.5 bg-slate-800 text-white text-sm font-medium rounded-lg hover:bg-slate-900 transition-colors shadow-sm">
                                            Vælg Filer
                                        </button>
                                        <input type="file" id="master-file-input" multiple accept=".xlsx,.xls" class="hidden" />
                                    </div>
                                </div>

                                <div id="master-error-message" class="hidden mt-2 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2">
                                    <svg class="w-5 h-5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>
                                    <p class="text-sm font-medium"></p>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">

                            <div id="status-card-axa" class="rounded-lg border border-slate-200 p-4 bg-white transition-colors duration-300">
                                <div class="flex items-center justify-between mb-2">
                                    <p class="font-semibold text-slate-900 text-sm">AXA Konverterede</p>
                                    <div id="icon-axa" class="text-slate-300">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                    </div>
                                </div>
                                <p id="filename-axa" class="text-xs text-slate-500 truncate">Mangler fil...</p>
                            </div>

                            <div id="status-card-axa-nonconverted" class="rounded-lg border border-slate-200 p-4 bg-white transition-colors duration-300">
                                <div class="flex items-center justify-between mb-2">
                                    <p class="font-semibold text-slate-900 text-sm">AXA Ikke-Konv.</p>
                                    <div id="icon-axa-nonconverted" class="text-slate-300">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                    </div>
                                </div>
                                <p id="filename-axa-nonconverted" class="text-xs text-slate-500 truncate">Mangler fil...</p>
                            </div>

                            <div id="status-card-naersikring" class="rounded-lg border border-slate-200 p-4 bg-white transition-colors duration-300">
                                <div class="flex items-center justify-between mb-2">
                                    <p class="font-semibold text-slate-900 text-sm">Nærsikring</p>
                                    <div id="icon-naersikring" class="text-slate-300">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                    </div>
                                </div>
                                <p id="filename-naersikring" class="text-xs text-slate-500 truncate">Mangler fil...</p>
                            </div>

                            <div id="status-card-afviste" class="rounded-lg border border-slate-200 p-4 bg-white transition-colors duration-300">
                                <div class="flex items-center justify-between mb-2">
                                    <p class="font-semibold text-slate-900 text-sm">Afviste Tilbud</p>
                                    <div id="icon-afviste" class="text-slate-300">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                    </div>
                                </div>
                                <p id="filename-afviste" class="text-xs text-slate-500 truncate">Mangler fil...</p>
                            </div>

                        </div>
                    </div>

                    <div class="flex flex-wrap gap-4 px-4 py-6">
                        <div class="flex min-w-full flex-1 flex-col gap-6 rounded-lg border border-slate-200 p-6 bg-white">
                            <div class="flex flex-col gap-4">
                                <p class="text-slate-900 text-xl font-bold leading-normal">Trin 2: Konverter alle filer</p>

                                <div class="text-center">
                                    <button id="convert-btn" disabled class="px-6 py-3 bg-slate-800 text-white font-medium rounded-lg hover:bg-slate-900 transition-colors disabled:bg-slate-300 disabled:cursor-not-allowed">
                                        Konverter til JavaScript
                                    </button>
                                    <p class="text-sm text-slate-500 mt-2">Alle fire filer skal være klar før konvertering kan starte</p>
                                </div>

                                <div id="axa-converting-progress-container" class="hidden">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-sm font-medium text-slate-700" id="axa-converting-progress-stage">Konverterer AXA data...</span>
                                        <span class="text-sm text-slate-600" id="axa-converting-progress-percentage">0%</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-2">
                                        <div id="axa-converting-progress-bar" class="bg-slate-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                                    </div>
                                </div>

                                <div id="axa-nonconverted-converting-progress-container" class="hidden">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-sm font-medium text-slate-700" id="axa-nonconverted-converting-progress-stage">Konverterer AXA Ikke Konverterede data...</span>
                                        <span class="text-sm text-slate-600" id="axa-nonconverted-converting-progress-percentage">0%</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-2">
                                        <div id="axa-nonconverted-converting-progress-bar" class="bg-orange-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                                    </div>
                                </div>

                                <div id="naersikring-converting-progress-container" class="hidden">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-sm font-medium text-slate-700" id="naersikring-converting-progress-stage">Konverterer Nærsikring data...</span>
                                        <span class="text-sm text-slate-600" id="naersikring-converting-progress-percentage">0%</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-2">
                                        <div id="naersikring-converting-progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                                    </div>
                                </div>

                                <div id="afviste-converting-progress-container" class="hidden">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-sm font-medium text-slate-700" id="afviste-converting-progress-stage">Konverterer Afviste data...</span>
                                        <span class="text-sm text-slate-600" id="afviste-converting-progress-percentage">0%</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-2">
                                        <div id="afviste-converting-progress-bar" class="bg-red-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                                    </div>
                                </div>

                                <div id="merge-progress-container" class="hidden">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-sm font-medium text-slate-700" id="merge-progress-stage">Sammenfletning af data...</span>
                                        <span class="text-sm text-slate-600" id="merge-progress-percentage">0%</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-2">
                                        <div id="merge-progress-bar" class="bg-green-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="directory-section" class="flex flex-wrap gap-4 px-4 py-6">
                        <div class="flex min-w-full flex-1 flex-col gap-6 rounded-lg border border-slate-200 p-6 bg-white">
                            <div class="flex flex-col gap-4">
                                <p class="text-slate-900 text-xl font-bold leading-normal">Trin 2.5: Vælg destination (valgfrit)</p>

                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4">
                                        <div class="flex-1">
                                            <p class="text-slate-700 text-sm font-medium mb-1">Automatisk gemning</p>
                                            <p class="text-slate-600 text-xs">Vælg en mappe hvor filen automatisk skal gemmes (kun understøttet i Chrome/Edge)</p>
                                            <p id="directory-info" class="hidden text-green-700 text-xs mt-1 font-medium"></p>
                                        </div>
                                        <button id="directory-select-btn" class="px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed">
                                            Vælg Mappe
                                        </button>
                                    </div>
                                </div>

                                <div class="text-xs text-slate-500 bg-slate-50 rounded p-3">
                                    <strong>Bemærk:</strong> Automatisk mappegemning virker kun i Chrome og Edge browsere. I andre browsere bruges standard download-funktionen.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex flex-wrap gap-4 px-4 pb-6">
                        <div class="flex min-w-full flex-1 flex-col gap-6 rounded-lg border border-slate-200 p-6 bg-white">
                            <div class="flex flex-col gap-4">
                                <p class="text-slate-900 text-xl font-bold leading-normal">Trin 3: Download samlet resultat</p>

                                <div id="success-message" class="hidden bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg">
                                    <div class="flex items-center gap-2">
                                        <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                        </svg>
                                        <p class="text-sm font-medium"></p>
                                    </div>
                                </div>

                                <div id="output-preview" class="hidden bg-slate-900 text-slate-100 p-4 rounded-lg overflow-auto max-h-64 text-sm font-mono whitespace-pre-wrap">
                                </div>

                                <div id="data-summary" class="hidden bg-slate-50 rounded-lg p-4">
                                    <h4 class="text-slate-900 font-semibold mb-3">Resultat oversigt:</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                                        <div>
                                            <span class="text-slate-600">Konverterede data:</span>
                                            <p class="text-slate-900 font-medium" id="converted-count">-</p>
                                        </div>
                                        <div>
                                            <span class="text-slate-600">Ikke-konverterede data:</span>
                                            <p class="text-slate-900 font-medium" id="nonconverted-count">-</p>
                                        </div>
                                        <div>
                                            <span class="text-slate-600">Afviste data:</span>
                                            <p class="text-slate-900 font-medium" id="afviste-count">-</p>
                                        </div>
                                    </div>
                                </div>

                                <div id="download-btn-container" class="hidden text-center">
                                    <button id="download-btn" class="px-6 py-3 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors">
                                        Download JavaScript-fil
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Shared JavaScript (loaded first) -->
    <script src="../js/shared/utils.js"></script>
    <script src="../js/shared/data-loader.js"></script>
    <script src="../js/shared/navigation.js"></script>

    <!-- SheetJS library for Excel processing -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>

    <!-- Page-specific JavaScript -->
    <script src="../js/data/converter-page.js"></script>
</body>
</html>
